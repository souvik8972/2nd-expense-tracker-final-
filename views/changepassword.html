<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Change Password</title>
</head>
<body>
    <h2>Change Password</h2>
    <form id="form" action="" method="post">
        <label for="password">New Password:</label>
        <input type="password" name="password" id="password" required>

        <label for="confirmPassword">Confirm Password:</label>
        <input type="password" name="confirmPassword" id="confirmPassword" required>

        <button type="button" onclick="resetPassword()">Reset Password</button>
    </form>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>
    <script>
       async function resetPassword() {
    const password = document.getElementById("password").value;
    const confirmPassword = document.getElementById("confirmPassword").value;
    console.log(password, confirmPassword);

    if (password !== confirmPassword) {
        alert("Password and Confirm Password do not match");
        return;
    }
    console.log(window.location.pathname)
    var parts = window.location.pathname.split('/');
var id = parts[parts.length - 2];
var token = parts[parts.length - 1];
console.log(id, token);
    if (!id || !token) {
        alert("Invalid URL parameters. Unable to reset password.");
        return;
    }

    try {
        const response = await axios.post(`/resetpassword/${id}/${token}`, {
            password: password,
            confirmPassword: confirmPassword
        });

        if (response.status === 200) {
            alert("Password reset successfully");
            // Redirect or perform additional actions as needed
        }
    } catch (error) {
        console.error(error);
        alert("Failed to reset password. Please try again.");
    }
}

   </script>
</body>
</html>
